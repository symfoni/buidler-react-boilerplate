
### We ‚ù§Ô∏è these **Ethereum** projects:

* [Buidler](https://buidler.dev/) with the Deploy plugin üë∑
* [Typechain üîå](https://github.com/ethereum-ts/Typechain#readme)
* [ethers.js v5](https://github.com/ethers-io/ethers.js#readme)

üò© Deployment and testing could be sooo tedious before. With these tools, we get Ethereum-projects, which are easy to develop, manage and maintain.

ü§î It's still kind of tedious, though. We have to find where every contract is deployed and connect them to the correct Typescript class before exporting it.

ü§© What if all of these tools worked in Symfoni? What if we wired all of this together and automatically generated the Typescript code; completely instancialized based on your smart contracts?

and have extended it with the possibility to generate a React context with:

* contract loading
* web3modal, ethers v5, and typed interfaces out of the box
* a great and simple way to store data outside of the TODO

### Enter our submission to the EthOnline 2020 hackathon!

# üéª Symfoni. CHECK FOR TODOS

> The tooling aggregator that makes your development process purr üòª

### Getting started with Symfoni


This tutorial will TODO

TODO test igjen

### OS Support

* MacOS
* Linux
* *The project has only been tested on MacOS and Linux. It should, in theory, work on Windows too. Don't hesitate to reach out if you experience problems.*

## ‚öôÔ∏è Setup new project

* Create an empty directory for the project and enter it:

`mkdir mySymfoniProject && cd mySymfoniProject`

* Use regular Buidler to create a project:

`npx @nomiclabs/buidler` 


>  If you don't have solidity files ready, select the `Create a sample project`. You must choose this if you wish to follow this tutorial all the way through. The npx command will ask you to install a couple of packages with npm. Copy, paste, and execute the npm command.

> If you do have project files to include, choose `Create an empty buidler.config.js` and copy/paste those solidity files into /contracts folder.

* Add Chai for testing in the dev environment:

`npm add --save-dev chai @types/node @types/mocha @types/chai`

* Create a deploy folder in the root:

`mkdir deploy`

* And [create a deployment file for each of your smart contracts](https://buidler.dev/plugins/buidler-deploy.html#deploy-scripts). If you chose to make a sample project in the first step, we have created a simple deploy script that you can use: 

```bash
echo 'import {
  BuidlerRuntimeEnvironment,
  DeployFunction,
} from "@nomiclabs/buidler/types";

const func: DeployFunction = async function(bre: BuidlerRuntimeEnvironment) {
  const { deploy } = bre.deployments;
  const { deployer } = await bre.getNamedAccounts();
  await deploy("Greeter", {
    from: deployer,
    // gas: 4000000,
    args: ["Hello from Buidler React!"],
  });
};
export default func;' > deploy/Greeter.ts
```

###  ü™Ñ Now let's add the Symfoni magic ‚ú®

* Up until now, this is all just a regular Buidler project. Now run this command to add our packages, including dependencies:

```bash
npm add @nomiclabs/buidler @symfoni/buidler-react @symfoni/buidler-typechain @typechain/ethers-v5 buidler-deploy buidler-ethers-v5 ethers ts-generator ts-node typechain typescript
```

* Convert the project to a Buidler Typescript project by overwriting Buidler with the Symfoni configuration files:

```bash
rm buidler.config.js 
cp node_modules/@symfoni/buidler-react/defaults/buidler.config.default.ts buidler.config.ts 
cp node_modules/@symfoni/buidler-react/defaults/tsconfig.default.json tsconfig.json
```

**Setup complete! ü•≥**


## üé® Lets create the front-end

* Generate the React app:

`npx create-react-app frontend --template typescript`

* To run the "back-end" execute `npx buidler node`. It 
  * start a development chain
  * compiles and deploys the contracts
  * generates the type interfaces for the contracts, and 
  * generate a react context to use those contracts as typed interfaces run.

* Go into the front-end folder: 

`cd frontend/`

* Then we need to add the dependencies:

> Note that the "Create React app" comes with an old version of Typescript, which is not compatible with Typechain, so let's also ensure Typescript is fixed at v3.9.7. Please note that v4 does not work.

`npm add web3modal ethers typescript@^3.9.7`

* Serve the generated front-end application:

`npm run start`

> A browser should start with the default "Create react app" webpage.

* Now, let's add the Buidler context to the front-end. Open in your code editor of choice, and open `/frontend/src/App.tsx`

* Add the React context generated by Symfoni to the imports on the top of the file. If you're using the Sample Project, it should be under `import './App.css';`

```typescript
import { BuidlerContext } from "./buidler/BuidlerContext‚Äù;`
```

* Wrap your app in this context to have it available to use in any children: `<BuidlerContext></BuidlerContext>`. In the Sample project, it should look like this:

```typescript
  <header className="App-header">
    <BuidlerContext>
      ‚Ä¶
    </BuidlerContext>
  </header>
```

**Front-end setup complete! üéâ**

You can now start developing your app or continue with the tutorial.

## üìô Tutorial 

You must have chosen `Create a sample project` way back in the first step to continue from here. Else you can extrapolate with your project setup. 

Let's create a component that consumes a smart contract and gives us some results. From the Buidler sample project, we have a smart contract called `Greeter.sol`.

* Create a `tsx` file for the view of the smart contract

`touch /frontend/component/Greeter.tsx`

* Open the file in your favorite editor and copy&paste:

```typescript
import React, { useContext, useEffect, useState } from 'react';
import { GreeterContext } from "./../buidler/BuidlerContext";

interface Props { }

export const Greeter: React.FC<Props> = () => {
    const greeter = useContext(GreeterContext)
    const [message, setMessage] = useState("");
    useEffect(() => {
        const doAsync = async () => {
            if (greeter.instance) {
                console.log("Greeter is deployed at ", greeter.instance.address)
                setMessage(await greeter.instance.greet())
            }
        };
        doAsync();
    }, [greeter])
    return (
        <div>
            <p>{message}</p>
        </div>
    )
}
```

Note that the Greeter context both provide you with

* a contract which contains all your functions, events and info, and
* a factory where you can let users quickly deploy new contract instances from the front-end.

Lets import this component into our app, which leaves our `App.tsx` like this:

```typescript
import React from 'react';
import logo from './logo.svg';
import './App.css';
import { BuidlerContext } from "./buidler/BuidlerContext";
import { Greeter } from './components/Greeter';

function App() {

  return (
    <div className="App">
      <header className="App-header">
        <BuidlerContext>
          <img src={logo} className="App-logo" alt="logo" />
          <p>
            Edit <code>src/App.tsx</code> and save to reload.
        </p>
          <a
            className="App-link"
            href="https://reactjs.org"
            target="_blank"
            rel="noopener noreferrer"
          >
            Learn React
        </a>
          <Greeter></Greeter>
        </BuidlerContext>
      </header>
    </div>
  );a
}

export default App;
```
> The buidler context will now ask `web3modal` for an injected provider. If it finds a provider, you should see the Greeting from the smart contract in the browser and the address the contract is deployed at in the console. 
 
[üìö You can see a full working example of the tutorial here.](https://github.com/symfoni/buidler-react-boilerplate)

**Thanks for completing our tutorial!**

We hope that you can use this to more efficiently write Ethereum applications üìà If you have any feedback, good or bad, please don't hesitate to ping us at [@_robertosnap](https://twitter.com/_robertosnap/)üê¶ or with a Issue here on Github.



# Bonus

* Example how to deploy a contract - https://github.com/symfoni/buidler-react-boilerplate/tree/bonus-greeter-deploy
* Example how to create and deploy an ERC20 - https://hackmd.io/@symfoni/r1qcTA3DD 


TODO CREDIT 
* Buidler
* Typechain
* Buidler-deploy
* Web3modal
